module.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.INITIALOPTIONS={zoom:14,scaleControl:!0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=void 0;n=isNaN(t)?t.length:t.toString().length;var o=[],a=(e=e||n)-n;return a>0&&(o.length=a),o.fill(0).join("")+t};e.getFlatternDistance=function(t,e,n,o){var a=function(t){return t*Math.PI/180};t=Number(t),e=Number(e),n=Number(n),o=Number(o);var r,i,p,m,s=a((t+n)/2),c=a((t-n)/2),l=a((e-o)/2),u=Math.sin(c),d=Math.sin(l),f=Math.sin(s);return r=(u*=u)*(1-(d*=d))+(1-(f*=f))*d,i=(1-u)*(1-d)+f*d,2*(p=Math.atan(Math.sqrt(r/i)))*6378137*(1+1/298.257*((3*(m=Math.sqrt(r*i)/p)-1)/2/i*f*(1-u)-(3*m+1)/2/r*(1-f)*u))},e.formatTime=function(t){t=new Date(t)||new Date;var e=void 0;try{e=t.getFullYear()+"-"+o(t.getMonth()+1,2)+"-"+o(t.getDate(),2)+"  "+o(t.getHours(),2)+":"+o(t.getMinutes(),2)+":"+o(t.getSeconds(),2)}catch(e){return console.log("xianTime Error",e),t}return e}},function(t,e){t.exports=require("prop-types")},function(t,e){t.exports=require("react")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(3),r=s(a),i=s(n(2)),p=n(1),m=n(0);function s(t){return t&&t.__esModule?t:{default:t}}var c=window.qq=window.qq||{};c.maps=c.maps||{};var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Component),o(e,[{key:"componentDidMount",value:function(){var t=this.props.apiKey;this._addScript("open.map.qq.com/apifiles/2/4/85/main.js",t)}},{key:"componentWillUnmount",value:function(){this.map&&c.maps.event.clearListeners(this.map)}},{key:"_addScript",value:function(t,e){var n=this,o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=location.protocol+"//"+t,document.body.appendChild(o),o.onload=function(){return n._initMap()};var a=(new Date).getTime();c.maps.__load=function(t){delete c.maps.__load,t([["2.4.85",e,0],["open.map.qq.com/","apifiles/2/4/85/mods/","open.map.qq.com/apifiles/2/4/85/theme/",!0],[1,18,34.519469,104.461761,4],[1519918617710,"pr.map.qq.com/pingd","pr.map.qq.com/pingd"],["apis.map.qq.com/jsapi","apikey.map.qq.com/mkey/index.php/mkey/check","sv.map.qq.com/xf","sv.map.qq.com/boundinfo","sv.map.qq.com/rarp","apis.map.qq.com/api/proxy/search","apis.map.qq.com/api/proxy/routes/","confinfo.map.qq.com/confinfo"],[[null,["rt0.map.gtimg.com/tile","rt1.map.gtimg.com/tile","rt2.map.gtimg.com/tile","rt3.map.gtimg.com/tile"],"png",[256,256],3,19,"114",!0,!1],[null,["m0.map.gtimg.com/hwap","m1.map.gtimg.com/hwap","m2.map.gtimg.com/hwap","m3.map.gtimg.com/hwap"],"png",[128,128],3,18,"110",!1,!1],[null,["p0.map.gtimg.com/sateTiles","p1.map.gtimg.com/sateTiles","p2.map.gtimg.com/sateTiles","p3.map.gtimg.com/sateTiles"],"jpg",[256,256],1,19,"101",!1,!1],[null,["rt0.map.gtimg.com/tile","rt1.map.gtimg.com/tile","rt2.map.gtimg.com/tile","rt3.map.gtimg.com/tile"],"png",[256,256],1,19,"",!1,!1],[null,["sv0.map.qq.com/hlrender/","sv1.map.qq.com/hlrender/","sv2.map.qq.com/hlrender/","sv3.map.qq.com/hlrender/"],"png",[256,256],1,19,"",!1,!1],[null,["rtt2.map.qq.com/rtt/","rtt2a.map.qq.com/rtt/","rtt2b.map.qq.com/rtt/","rtt2c.map.qq.com/rtt/"],"png",[256,256],1,19,"",!1,!1],null,[["rt0.map.gtimg.com/vector/","rt1.map.gtimg.com/vector/","rt2.map.gtimg.com/vector/","rt3.map.gtimg.com/vector/"],[256,256],3,18,"114",["rt0.map.gtimg.com/icons/","rt1.map.gtimg.com/icons/","rt2.map.gtimg.com/icons/","rt3.map.gtimg.com/icons/"]],null],["s.map.qq.com/TPano/v1.1.2/TPano.js","map.qq.com/",""]],a)}}},{key:"_initMap",value:function(){var t=this,e=this.props,n=e.initialOptions,o=e.orderList,a=e.boxInfo,r=Object.assign({},m.INITIALOPTIONS,n),i=Number(a.lat),p=Number(a.lng),s=new c.maps.LatLng(i,p),l=new c.maps.LatLng(i+.2,p+.2),u=new c.maps.LatLng(i-.2,p-.2),d=new c.maps.LatLngBounds(u,l);r.center=s,r.boundary=d,r.zoomControlOptions={style:c.maps.ZoomControlStyle.SMALL,position:c.maps.ControlPosition.RIGHT_BOTTOM},r.panControlOptions={position:c.maps.ControlPosition.RIGHT_BOTTOM},this.map=new c.maps.Map(this.mapContainer,r),c.maps.event.addListener(this.map,"click",function(e){t.infoWindow&&t.infoWindow.close()}),this._addPolygon(i,p),this._addXianMarker(a),o&&this._addOrderMarker(o,a)}},{key:"_addPolygon",value:function(t,e){var n=[new c.maps.LatLng(t+.2,e+.2),new c.maps.LatLng(t+.2,e-.2),new c.maps.LatLng(t-.2,e-.2),new c.maps.LatLng(t-.2,e+.2)];new c.maps.Polygon({path:n,map:this.map,fillColor:new c.maps.Color(0,0,0,.05)})}},{key:"_addXianMarker",value:function(t){var e=new c.maps.LatLng(t.lat,t.lng),n=function(t){c.maps.Overlay.call(this,t)};(n.prototype=new c.maps.Overlay).construct=function(){this.dom=document.createElement("div"),this.dom.style.cssText="background:#f00;font-size:8px;color:#fff;position:absolute;display:flex;justify-content:center;align-items:center;width:28px;height:28px;border-radius:14px;",this.dom.innerHTML=this.get("initHtml"),this.getPanes().overlayLayer.appendChild(this.dom)},n.prototype.draw=function(){var t=this.get("position");if(t){var e=this.getProjection().fromLatLngToDivPixel(t);this.dom.style.left=e.getX()-14+"px",this.dom.style.top=e.getY()-14+"px"}},n.prototype.destroy=function(){this.dom.parentNode.removeChild(this.dom)},new n({map:this.map,position:e,initHtml:"鲜库"})}},{key:"_addOrderMarker",value:function(t,e){var n=this;this.infoWindow=new c.maps.InfoWindow({map:this.map}),t.forEach(function(t,o){var a=t.addressInfo,r=t.sendDay,i=t.sendTime,m=t.orderNumber,s=t.createdAt;if(a){var l=new c.maps.LatLng(a.coordinate.lat,a.coordinate.lng),u=new c.maps.MarkerDecoration('<span style="color: #fff; cursor: pointer;">'+(o+1)+"</span>"),d=(0,p.getFlatternDistance)(a.coordinate.lat,a.coordinate.lng,e.lat,e.lng),f=new c.maps.Marker({position:l,map:n.map,decoration:u,animation:c.maps.MarkerAnimation.DROP});c.maps.event.addListener(f,"mouseover",function(){n.infoWindow.open(),n.infoWindow.setContent('<div style="text-align:center;maigin:10px;width:300px;">\n                        <table width="100%" border="0" cellspacing="1" cellpadding="10">\n                            <tr>\n                                <th>'+m+"</th>\n                                <th>"+(0,p.formatTime)(s)+'</th>\n                            </tr>\n                        </table>\n                        <table width="100%" border="1" cellspacing="0" cellpadding="4">\n                            <tr>\n                                <td width="30%">订单类型</td>\n                                <td>'+("tomorrow"===r?"明日达":"presale"===r?"预售":"快速达")+'</td>\n                            </tr>\n                            <tr>\n                                <td width="30%">联系人信息</td>\n                                <td>'+a.receiver+"&#x3000;"+a.phoneNumber+'</td>\n                            </tr>\n                            <tr>\n                                <td width="30%">订单地址<br/>距离：'+(d/1e3).toFixed(2)+"km</td>\n                                <td>"+(a.detail+a.unitNumber)+'</td>\n                            </tr>\n                            <tr>\n                                <td width="30%">配送时间</td>\n                                <td>'+(i?"presale"==r?"预售"+i+"送达":i.replace("T"," "):"即时配送")+"</td>\n                            </tr>\n                        </table>\n                    </div>"),n.infoWindow.setPosition(l)})}})}},{key:"render",value:function(){var t=this,e=this.props,n=e.className,o=e.style;return o.width="100%",o.height="100%",r.default.createElement("div",{ref:function(e){return t.mapContainer=e},style:o,className:n})}}]),e}();l.prototypes={initialOptions:i.default.object,style:i.default.object,className:i.default.string,apiKey:i.default.string.isRequired,orderList:i.default.array,boxInfo:i.default.object.isRequired},e.default=l}]);